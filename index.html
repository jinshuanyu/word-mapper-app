<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no"/>
  <title>è‹±æ–‡æ‹¼å­— Ã— è²éŸ³å°ç…§</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800&family=Noto+Sans:wght@400;700&family=Noto+Sans+TC:wght@400;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

  <style>
    :root{ --c-primary:#887ea6; --c-secondary:#10b981; --c-text:#1f2937; --c-bg:#f8fafc; --c-border:#e2e8f0; }

    /* tag é¡åˆ¥è‰² */
    .tag-cvc{background:#fef3c7;border-color:#f59e0b;color:#92400e}
    .tag-closed{background:#fee2e2;border-color:#ef4444;color:#991b1b}
    .tag-open{background:#e0f2fe;border-color:#38bdf8;color:#075985}
    .tag-magic_e{background:#ede9fe;border-color:#8b5cf6;color:#4c1d95}
    .tag-vowel_team{background:#dcfce7;border-color:#22c55e;color:#14532d}
    .tag-rcontrolled{background:#fae8ff;border-color:#e879f9;color:#86198f}
    .tag-digraph{background:#f1f5f9;border-color:#94a3b8;color:#0f172a}
    .tag-cluster{background:#ffe4e6;border-color:#fb7185;color:#881337}
    .tag-suffix{background:#dbeafe;border-color:#60a5fa;color:#1e3a8a}
    .tag-silent_consonant{background:#f5f5f4;border-color:#a8a29e;color:#1c1917}
    .tag-irregular{background:#fef9c3;border-color:#eab308;color:#713f12}

    /* Reset & base */
    *{box-sizing:border-box}
    html,body{margin:0;padding:0}
    body{
      font-family: Inter, "Noto Sans TC", "Noto Sans", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background:var(--c-bg); color:var(--c-text); line-height:1.6;
    }
    a{color:inherit;text-decoration:none}
    .container{max-width:1100px;margin:0 auto;padding:16px 16px 72px}

    /* Header */
    header{
      position:sticky; top:0; z-index:20;
      background:rgba(248,250,252,.75); backdrop-filter:saturate(180%) blur(10px);
      border-bottom:1px solid var(--c-border);
    }
    .header-inner{display:flex;align-items:center;gap:12px;padding:10px 16px}
    .logo{font-weight:800;font-size:1.1rem;letter-spacing:.3px}
    .spacer{flex:1}
    .btn{
      display:inline-flex;align-items:center;gap:.5rem;padding:.5rem .9rem;border-radius:10px;border:1.5px solid var(--c-border);
      background:#fff; font-weight:700; cursor:pointer; transition:transform .1s ease, box-shadow .2s ease, border-color .2s ease;
    }
    .btn:hover{transform:translateY(-1px);box-shadow:0 6px 14px rgba(2,6,23,.08);border-color:#cbd5e1}
    .btn i{font-size:1rem}
    .btn .label{font-size:.95rem}

    /* Search row */
    .toolbar{display:flex;flex-wrap:wrap;gap:.75rem;margin:.75rem 0 0}
    .search{display:flex;align-items:center;gap:.5rem;background:#fff;border:1.5px solid var(--c-border);padding:.5rem .75rem;border-radius:12px;flex:1;min-width:240px}
    .search i{opacity:.6}
    .search input{border:none;outline:none;font-size:1rem;width:100%}
    .dropdowns{display:flex;gap:.5rem;flex:0 0 auto}
    .select{background:#fff;border:1.5px solid var(--c-border);border-radius:12px;padding:.5rem .75rem;font-weight:700}
    .select:focus{outline:none;border-color:#cbd5e1}

    /* Pages */
    .page-section{display:none}
    .page-section.active{display:block}

    /* Home list placeholder (we now use dropdowns) */
    .topic-list{list-style:none;padding:0;width:min(100%,700px);margin-top:1rem}

    /* Legend / tags */
    .legend{display:flex;flex-wrap:wrap;gap:.5rem;padding:0 .25rem .25rem;margin:0 0 1.25rem 0;list-style:none;}
    .legend .legend-item{display:inline-flex;flex:0 0 auto;padding:.3rem .75rem;border-radius:999px;font-size:.9rem;font-weight:700;border:2px solid;white-space:nowrap;user-select:none;transition:transform .1s ease,opacity .2s ease}
    .legend .legend-item:hover{transform:scale(1.05)}
    .legend .legend-item.selected{outline:3px solid rgba(14,165,233,.25)}
    .tag-all{background:#e5e7eb;border-color:#94a3b8;color:#334155}
    .category-tag{padding:.3rem .75rem;border-radius:999px;font-weight:700;border:2px solid;white-space:nowrap;user-select:none}

    .topic-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:1.25rem}
    .word-card{border:2px solid #cbd5e1;border-radius:12px;background:#fff;box-shadow:0 6px 14px rgba(2,6,23,.06), 0 2px 6px rgba(2,6,23,.03);overflow:hidden;transition:transform .2s,box-shadow .2s}
    .word-card.hidden{display:none}
    .word-card:hover{transform:translateY(-2px);box-shadow:0 20px 40px rgba(2,6,23,.08), 0 8px 16px rgba(2,6,23,.04)}
    .card-hd{display:flex;align-items:center;justify-content:space-between;padding:.75rem 1rem;border-bottom:1px dashed #e5e7eb;background:linear-gradient(#fff, #fafafa)}
    .word{font-weight:800;font-size:1.1rem}
    .pos{font-weight:700;opacity:.7}
    .number{font-size:.95rem;opacity:.8}
    .ipa,.phonics{font-family: "Noto Sans", "Noto Sans TC", Inter, system-ui; font-size:1rem;margin:.5rem 1rem 0}
    .ipa .label,.phonics .label{font-weight:700;opacity:.8;margin-right:.25rem}
    .split{display:grid;grid-template-columns:1fr 1fr;gap:.5rem;padding:1rem}
    .col{border:1.5px dashed #e5e7eb;border-radius:10px;padding:.6rem .75rem}
    .col .tt{font-size:.85rem;font-weight:800;opacity:.7;margin-bottom:.4rem}
    .g-box,.p-box{display:flex;flex-wrap:wrap;gap:.4rem}
    .grapheme-box,.phoneme-box{display:inline-flex;align-items:center;justify-content:center;padding:.35rem .55rem;border:1.5px solid #cbd5e1;border-radius:8px;font-weight:800}
    .grapheme-box.heart{border-style:solid;border-color:#ef4444}
    .hint{padding:0 1rem 1rem;opacity:.8;font-size:.92rem}
    .g-tags{display:flex;gap:.35rem;flex-wrap:wrap;padding:0 1rem 1rem}
    .g-tag{border-radius:999px;font-size:.8rem;font-weight:800;padding:.25rem .55rem;border:1.5px solid #e5e7eb}
    .g-tag.heart{border-color:#ef4444;color:#991b1b;background:#fee2e2}

    /* Toggle */
    .toggle-container{display:flex;align-items:center;gap:.75rem;margin:.5rem 0 1rem}
    .toggle-label-ipa,.toggle-label-phonics{font-weight:800;opacity:.8}
    .switch{position:relative;display:inline-block;width:52px;height:28px}
    .switch input{display:none}
    .slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background:#e5e7eb;border:1px solid #cbd5e1;transition:.2s;border-radius:999px}
    .slider:before{position:absolute;content:"";height:22px;width:22px;left:3px;top:50%;transform:translateY(-50%);background:white;border-radius:50%;transition:.2s;box-shadow:0 2px 6px rgba(2,6,23,.15)}
    input:checked + .slider{background:#dbeafe;border-color:#93c5fd}
    input:checked + .slider:before{transform:translate(22px, -50%)}

    /* Footer */
    footer{position:fixed;left:0;right:0;bottom:0;border-top:1px solid var(--c-border);background:#fff}
    .footer-inner{max-width:1100px;margin:0 auto;padding:10px 16px;display:flex;align-items:center;gap:10px;justify-content:space-between}
    .note{opacity:.7;font-size:.9rem}
    .links{display:flex;gap:.75rem}
    .links a{display:inline-flex;align-items:center;gap:.35rem;padding:.35rem .6rem;border:1.5px solid var(--c-border);border-radius:10px;font-weight:700}
  </style>
</head>
<body>
  <header>
    <div class="header-inner">
      <div class="logo">ğŸ”¡ è‹±æ–‡æ‹¼å­— Ã— è²éŸ³å°ç…§</div>
      <div class="spacer"></div>
      <button id="btnHome" class="btn"><i class="fa-solid fa-list"></i><span class="label">è¿”å›ç›®éŒ„</span></button>
      <button id="btnSearch" class="btn"><i class="fa-solid fa-magnifying-glass"></i><span class="label">æœå°‹</span></button>
    </div>
    <div class="container">
      <div class="toolbar">
        <div class="search">
          <i class="fa-solid fa-magnifying-glass"></i>
          <input id="searchInput" type="text" placeholder="è¼¸å…¥å–®å­—æˆ–æç¤ºé—œéµå­—..." />
        </div>
        <div class="dropdowns">
          <select id="selTopic" class="select">
            <option value="">é¸æ“‡ä¸»é¡Œ</option>
          </select>
          <select id="selLevel" class="select">
            <option value="">é¸æ“‡ç­‰ç´š</option>
          </select>
        </div>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Home Page -->
    <section id="homePage" class="page-section active">
      <ul class="topic-list" id="topicList"></ul>
    </section>

    <!-- å‹•æ…‹é é¢æ’å…¥é» -->
    <section id="dynamicContainer"></section>
  </main>

  <footer>
    <div class="footer-inner">
      <div class="note">Ver. 2025-11-11 | Word Mapper (Data-driven)</div>
      <div class="links">
        <a href="#"><i class="fa-solid fa-circle-question"></i> èªªæ˜</a>
        <a href="#"><i class="fa-brands fa-github"></i> GitHub</a>
      </div>
    </div>
  </footer>

  <script>
    // ====== å·¥å…·ï¼šéŸ³æª”å¿«å– ======
    const audioCache = new Map();
    function ensureAudio(url){
      if(audioCache.has(url)) return audioCache.get(url);
      const a = new Audio(url); audioCache.set(url,a); return a;
    }
    function playAudio(url){
      const a = ensureAudio(url);
      a.currentTime = 0;
      a.play().catch(()=>{});
    }

    // ====== IPA â†’ æª”åå°æ‡‰ï¼ˆç¤ºä¾‹ï¼‰ ======
    function phonemeUrl(raw){
      if(!raw) return '';
      const s = raw.replace(/[\/\s]/g,''); // ç§»é™¤æ–œç·šèˆ‡ç©ºç™½
      // ä¾ä½ å¯¦éš›æª”åè¦å‰‡èª¿æ•´ï¼š
      const map = {
        "p":"audio/phonemes/p.mp3","b":"audio/phonemes/b.mp3","t":"audio/phonemes/t.mp3","d":"audio/phonemes/d.mp3",
        "k":"audio/phonemes/k.mp3","g":"audio/phonemes/g.mp3","f":"audio/phonemes/f.mp3","v":"audio/phonemes/v.mp3",
        "Î¸":"audio/phonemes/th_voiceless.mp3","Ã°":"audio/phonemes/th_voiced.mp3",
        "s":"audio/phonemes/s.mp3","z":"audio/phonemes/z.mp3","Êƒ":"audio/phonemes/sh.mp3","Ê’":"audio/phonemes/zh.mp3",
        "tÊƒ":"audio/phonemes/ch.mp3","dÊ’":"audio/phonemes/j.mp3",
        "m":"audio/phonemes/m.mp3","n":"audio/phonemes/n.mp3","Å‹":"audio/phonemes/ng.mp3",
        "h":"audio/phonemes/h.mp3","l":"audio/phonemes/l.mp3","r":"audio/phonemes/r.mp3","w":"audio/phonemes/w.mp3","j":"audio/phonemes/y.mp3",
        "i":"audio/phonemes/i.mp3","Éª":"audio/phonemes/ih.mp3","e":"audio/phonemes/e.mp3","É›":"audio/phonemes/eh.mp3",
        "Ã¦":"audio/phonemes/ae.mp3","É‘":"audio/phonemes/ah.mp3","É”":"audio/phonemes/aw.mp3","o":"audio/phonemes/o.mp3",
        "ÊŠ":"audio/phonemes/uh.mp3","u":"audio/phonemes/oo.mp3","ÊŒ":"audio/phonemes/uh_short.mp3","É™":"audio/phonemes/schwa.mp3","Éš":"audio/phonemes/er.mp3",
        "eÉª":"audio/phonemes/ei.mp3","aÉª":"audio/phonemes/ai.mp3","É”Éª":"audio/phonemes/oi.mp3","oÊŠ":"audio/phonemes/ou.mp3","aÊŠ":"audio/phonemes/au.mp3"
      };
      return map[s] || '';
    }

    // ====== äº‹ä»¶ï¼šæ‡¸åœé è¼‰éŸ³æª” ======
    function setupAudioPrefetchListeners(){
      document.addEventListener('mouseover',(e)=>{
        const cell = e.target.closest('.phoneme-box');
        if(cell){ const raw = cell.textContent; const url = phonemeUrl(raw); if(url) ensureAudio(url); }
      }, { passive:true });

      document.addEventListener('touchstart',(e)=>{
        if(!e.target.closest('.phoneme-box')) return;
        const cell = e.target.closest('.phoneme-box');
        if(cell){ const raw = cell.textContent; const url = phonemeUrl(raw); if(url) ensureAudio(url).catch(()=>{}); }
      }, { passive:true });
    }
    setupAudioPrefetchListeners();

    // ====== ç‹€æ…‹èˆ‡æ¸²æŸ“ ======
    let selectedFilter = 'all'; // é è¨­é¡¯ç¤ºå…¨éƒ¨ï¼Œä¸è®€å– sessionStorage
    let currentTopicData=[];
    let isPhonicsMode=false;

    function initTopicPage(contentId){
      const cnt=document.getElementById(contentId);
      if(!cnt) return;

      const allTags=['all','cvc','closed','open','magic_e','vowel_team','rcontrolled','digraph','cluster','suffix','silent_consonant','irregular'];
      const usedTags=new Set(['all']);
      currentTopicData.forEach(w=>{ (w.tags||[]).forEach(t=>usedTags.add(t)); });
      const existing=allTags.filter(t=>usedTags.has(t));

      let legendHTML='<ul class="legend">';
      existing.forEach(t=>{
        const name = tagNames[t] || t;
        const cls=(t==='all')?'tag-all':`tag-${t}`;
        const sel=(t===selectedFilter)?'selected':'';
        legendHTML+=`<li class="legend-item ${cls} ${sel}" data-filter="${t}">${name}</li>`;
      });
      legendHTML+='</ul>';

      const toggleHTML=`
        <div class="toggle-container">
          <span class="toggle-label-ipa">IPA éŸ³æ¨™</span>
          <label class="switch">
            <input type="checkbox" id="toggle_${contentId}" ${isPhonicsMode?'checked':''}>
            <span class="slider"></span>
          </label>
          <span class="toggle-label-phonics">Phonics æ‹¼éŸ³</span>
        </div>
        <p class="a11y" aria-live="polite" style="position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden;">åˆ‡æ› IPA æˆ– Phonics é¡¯ç¤ºæ¨¡å¼</p>
      `;

      const contentHTML=`${legendHTML}${toggleHTML}<div class="topic-grid" id="grid-${contentId}"></div>`;
      cnt.innerHTML=contentHTML;

      // ç¶å®š toggle
      const toggle = cnt.querySelector(`#toggle_${contentId}`);
      toggle.addEventListener('change',()=>{
        isPhonicsMode = toggle.checked;
        renderGrid(contentId);
      });

      // ç¶å®š legend
      cnt.querySelectorAll('.legend-item').forEach(li=>{
        li.addEventListener('click',()=>{
          selectedFilter = li.getAttribute('data-filter')||'all';
          // ä¸å†æŒä¹…åŒ– selectedFilter
          cnt.querySelectorAll('.legend-item').forEach(x=>x.classList.remove('selected'));
          li.classList.add('selected');
          applyFilters(contentId);
        });
      });

      renderGrid(contentId);
      applyFilters(contentId);
    }

    function renderGrid(contentId){
      const grid=document.getElementById(`grid-${contentId}`);
      if(!grid) return;
      const items = currentTopicData.map(w=>{
        const hearts = (w.hearts||[]).map(Boolean);
        const gHtml = (w.graphemes||[]).map((g,i)=>{
          const isHeart = hearts[i]===true;
          return `<div class="grapheme-box${isHeart?' heart':''}">${g}</div>`;
        }).join('');
        const pHtml = (w.phonemes||[]).map((p)=>`<div class="phoneme-box" tabindex="0" role="button" aria-label="æ’­æ”¾éŸ³ç´  ${p}">${p}</div>`).join('');
        const tagHtml = (w.tags||[]).map(t=>`<span class="g-tag ${t==='irregular'?'heart':''}">${tagNames[t]||t}</span>`).join('');

        const ipa = w.ipa || '';
        const phonics = (w.phonics||[]).join(' ');
        const phonicsLine = `<div class="phonics"><span class="label">Phonics</span> ${phonics}</div>`;
        const ipaLine = `<div class="ipa"><span class="label">IPA</span> ${ipa}</div>`;

        return `
          <article class="word-card" data-tags="${(w.tags||[]).join(',')}">
            <div class="card-hd">
              <div class="word">${w.word||''}</div>
              <div class="pos">${w.pos||''}</div>
            </div>
            ${isPhonicsMode ? phonicsLine : ipaLine}
            <div class="split">
              <div class="col">
                <div class="tt">Graphemes</div>
                <div class="g-box">${gHtml}</div>
              </div>
              <div class="col">
                <div class="tt">Phonemes</div>
                <div class="p-box">${pHtml}</div>
              </div>
            </div>
            <div class="hint">${w.hint||''}</div>
            <div class="g-tags">${tagHtml}</div>
          </article>
        `;
      }).join('');
      grid.innerHTML=items;

      // ç¶å®šæ’­æ”¾éŸ³æª”
      grid.querySelectorAll('.phoneme-box').forEach(el=>{
        el.addEventListener('click',()=>{
          const raw = el.textContent;
          const url = phonemeUrl(raw);
          if(url) playAudio(url);
        });
        el.addEventListener('keydown',(ev)=>{
          if(ev.key==='Enter' || ev.key===' '){
            ev.preventDefault();
            const raw = el.textContent;
            const url = phonemeUrl(raw);
            if(url) playAudio(url);
          }
        });
      });
    }

    function applyFilters(contentId){
      const grid=document.getElementById(`grid-${contentId}`);
      if(!grid) return;
      const cards=[...grid.querySelectorAll('.word-card')];
      cards.forEach(card=>{
        if(selectedFilter==='all'){ card.classList.remove('hidden'); return; }
        const tags=(card.getAttribute('data-tags')||'').split(',').filter(Boolean);
        if(tags.includes(selectedFilter)) card.classList.remove('hidden');
        else card.classList.add('hidden');
      });
    }

    // ====== tag é¡¯ç¤ºåç¨± ======
    const tagNames = {
      all:'å…¨éƒ¨',
      cvc:'CVC',
      closed:'é–‰éŸ³ç¯€',
      open:'é–‹éŸ³ç¯€',
      magic_e:'Magic-e',
      vowel_team:'æ¯éŸ³çµ„åˆ',
      rcontrolled:'R-controlled',
      digraph:'äºŒåˆå­—æ¯',
      cluster:'å­éŸ³é€£ç¶´',
      suffix:'å­—å°¾',
      silent_consonant:'ä¸ç™¼éŸ³å­éŸ³',
      irregular:'ä¸è¦å‰‡'
    };

    // ====== é¡Œåº«ç´¢å¼•ï¼ˆç¤ºæ„ï¼‰ ======
    const DATA_INDEX = [
      { slug:'topic01_10', title:'Topic 01 (21â€“30)', levels:[1,2], file:'data/topic01_10.json' },
      { slug:'topic11_20', title:'Topic 02 (31â€“40)', levels:[1,2], file:'data/topic11_20.json' }
    ];

    // ====== ç›®éŒ„æ¸²æŸ“ ======
    function renderHome(){
      const ul=document.getElementById('topicList');
      ul.innerHTML = DATA_INDEX.map((t,i)=>`<li><a href="#" data-slug="${t.slug}" class="topic-link">ğŸ“ ${t.title}</a></li>`).join('');
      ul.querySelectorAll('.topic-link').forEach(a=>{
        a.addEventListener('click',(e)=>{
          e.preventDefault();
          const slug = a.getAttribute('data-slug');
          loadTopic(slug, 1);
        });
      });
    }

    // ====== è¼‰å…¥è³‡æ–™ ======
    async function loadTopic(slug, level){
      const entry = DATA_INDEX.find(x=>x.slug===slug);
      if(!entry) return;
      try{
        const res = await fetch(entry.file);
        const json = await res.json();
        // ä¾ level ç¯©é¸ï¼ˆç¤ºä¾‹ï¼‰
        currentTopicData = (json.items||[]).filter(it=>!it.level || it.level===level);
        // å‹•æ…‹æ’å…¥é é¢
        const pageId = `${slug}_${level}_Page`;
        ensurePage(pageId, entry.title, slug, level);
        showPage(pageId);
      }catch(err){
        console.error('loadTopic error', err);
      }
    }

    function ensurePage(pageId, title, slug, level){
      const container = document.getElementById('dynamicContainer');
      if(!document.getElementById(pageId)){
        const html = `
          <section id="${pageId}" class="page-section">
            <h2 style="margin:1rem 0 .25rem">${title} Â· Level ${level}</h2>
            <div id="content-${pageId}"></div>
          </section>`;
        container.insertAdjacentHTML('beforeend', html);
      }
      // åˆå§‹åŒ– toolbar çš„ä¸‹æ‹‰
      document.getElementById('selTopic').value = slug;
      document.getElementById('selLevel').value = String(level);
      initTopicPage(`content-${pageId}`);
    }

    function showPage(pageId){
      selectedFilter = 'all'; // åˆ‡æ›é é¢æ™‚é‡ç½®ç¯©é¸ç‚ºå…¨éƒ¨
      document.querySelectorAll('.page-section').forEach(p=>p.classList.remove('active'));
      const active = document.getElementById(pageId);
      if(!active) return;
      active.classList.add('active');
      window.scrollTo({ top: 0, behavior: 'smooth' });

      const m = pageId.match(/^(.+?)_(\d+)_Page$/);
      if(!m) return; // home
      const slug = m[1], level = Number(m[2]);
      // é‡è¨­ legend é«˜äº®ï¼šinitTopicPage å·²ä¾ selectedFilter=all è™•ç†
      applyFilters(`content-${pageId}`);
    }

    // ====== æœå°‹ï¼ä¸‹æ‹‰äº‹ä»¶ ======
    document.getElementById('btnHome').addEventListener('click',()=>{
      document.querySelectorAll('.page-section').forEach(p=>p.classList.remove('active'));
      document.getElementById('homePage').classList.add('active');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    document.getElementById('btnSearch').addEventListener('click',()=>{
      document.getElementById('searchInput').focus();
    });

    document.getElementById('selTopic').addEventListener('change',()=>{
      const slug = document.getElementById('selTopic').value;
      const lvl = Number(document.getElementById('selLevel').value || 1);
      if(slug) loadTopic(slug, lvl);
    });

    document.getElementById('selLevel').addEventListener('change',()=>{
      const slug = document.getElementById('selTopic').value;
      const lvl = Number(document.getElementById('selLevel').value || 1);
      if(slug) loadTopic(slug, lvl);
    });

    document.getElementById('searchInput').addEventListener('input',(e)=>{
      const q = (e.target.value||'').trim().toLowerCase();
      const active = document.querySelector('.page-section.active');
      if(!active || active.id==='homePage') return;
      const contentId = `content-${active.id}`;
      const grid = document.getElementById(`grid-${contentId}`);
      if(!grid) return;
      [...grid.querySelectorAll('.word-card')].forEach(card=>{
        const text = card.textContent.toLowerCase();
        if(!q){ // æ²’æœ‰æœå°‹å­—ä¸² â†’ å›åˆ°ç›®å‰çš„ filter çµæœ
          if(selectedFilter==='all') card.classList.remove('hidden');
          else{
            const tags=(card.getAttribute('data-tags')||'').split(',').filter(Boolean);
            if(tags.includes(selectedFilter)) card.classList.remove('hidden');
            else card.classList.add('hidden');
          }
        }else{
          card.classList.toggle('hidden', !text.includes(q));
        }
      });
    });

    // ====== å•Ÿå‹• ======
    renderHome();
  </script>
</body>
</html>
